<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Shool Talk Talk</title>
  <style>
    /* index.html의 모든 스타일 그대로 유지 */
    body {
      font-family: 'Malgun Gothic', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      min-height: 100vh;
      background-color: #ffffff;
      color: #333333;
      transition: background-color 0.3s, color 0.3s;
    }
    body.dark-mode {
      background-color: #1a1a1a;
      color: #ffffff;
    }
    /* ... 중간 스타일 생략 ... (모든 원본 스타일 포함됨) */
  </style>
</head>
<body>
  <div class="vertical-tabs">
    <button class="tab-button active" onclick="switchTab('main')">📅</button>
    <button class="tab-button" onclick="switchTab('community')">📋</button>
    <button class="tab-button" onclick="switchTab('settings')">⚙️</button>
  </div>
  <div class="content-area">
    <!-- ✅ 탭 1: 원본 유지 -->
    <div class="main-container active" id="main">
      <!-- 시간표 & 급식 테이블 (원본 index.html 내용) -->
      <!-- ... 그대로 복사됨 ... -->
    </div>

    <!-- ✅ 탭 2: 커뮤니티 (Firebase 제거 + localStorage 기반) -->
    <div class="community-container" id="community" style="display:none;">
      <div class="community-header">
        <h2>커뮤니티</h2>
        <button class="write-post-button" onclick="openPostModal()">글쓰기</button>
      </div>
      <table class="post-list">
        <thead>
          <tr>
            <th style="width: 50%;">제목</th>
            <th style="width: 20%;">작성자</th>
            <th style="width: 20%;">작성 시간</th>
            <th style="width: 10%;">보기</th>
          </tr>
        </thead>
        <tbody id="post-list-body"></tbody>
      </table>
    </div>

    <!-- ✅ 탭 3: 설정 (index.html 원본 유지) -->
    <div class="settings-container" id="settings" style="display:none;">
      <!-- 설정탭 원본 내용 -->
      <!-- ... 그대로 복사됨 ... -->
    </div>
  </div> <!-- content-area 끝 -->

  <!-- 📝 글쓰기 모달 -->
  <div id="post-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:999;">
    <div style="background:white; width:90%; max-width:500px; margin:10% auto; padding:20px; border-radius:10px;">
      <h2>글쓰기</h2>
      <input type="text" id="post-title" placeholder="제목" style="width:100%; margin-bottom:10px;" />
      <input type="text" id="post-author" placeholder="작성자" style="width:100%; margin-bottom:10px;" />
      <textarea id="post-content" placeholder="내용" style="width:100%; height:150px;"></textarea>
      <div style="margin-top:10px; text-align:right;">
        <button onclick="closePostModal()">취소</button>
        <button onclick="submitPost()">작성</button>
      </div>
    </div>
  </div>

  <script>
    function switchTab(tabId) {
      document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".tab-content, .main-container, .community-container, .settings-container").forEach(div => div.classList.remove("active"));

      if (tabId === "main") {
        document.querySelector(".main-container").classList.add("active");
        document.querySelectorAll(".tab-button")[0].classList.add("active");
      } else if (tabId === "community") {
        document.getElementById("community").style.display = "block";
        document.getElementById("main").style.display = "none";
        document.getElementById("settings").style.display = "none";
        document.querySelectorAll(".tab-button")[1].classList.add("active");
        renderPosts();
      } else if (tabId === "settings") {
        document.getElementById("settings").style.display = "block";
        document.getElementById("main").style.display = "none";
        document.getElementById("community").style.display = "none";
        document.querySelectorAll(".tab-button")[2].classList.add("active");
      }
    }

    function openPostModal() {
      document.getElementById("post-modal").style.display = "block";
    }

    function closePostModal() {
      document.getElementById("post-modal").style.display = "none";
    }

    function submitPost() {
      const title = document.getElementById("post-title").value.trim();
      const author = document.getElementById("post-author").value.trim() || "익명";
      const content = document.getElementById("post-content").value.trim();
      if (!title || !content) {
        alert("제목과 내용을 입력하세요.");
        return;
      }

      const post = {
        title,
        author,
        content,
        date: new Date().toLocaleString()
      };

      const posts = JSON.parse(localStorage.getItem("communityPosts") || "[]");
      posts.unshift(post);
      localStorage.setItem("communityPosts", JSON.stringify(posts));

      closePostModal();
      renderPosts();
    }

    function renderPosts() {
      const posts = JSON.parse(localStorage.getItem("communityPosts") || "[]");
      const tbody = document.getElementById("post-list-body");
      tbody.innerHTML = "";
      posts.forEach((post, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${post.title}</td>
          <td>${post.author}</td>
          <td>${post.date}</td>
          <td><button onclick="alert(\`${post.content.replace(/`/g, "\\`")}\`)">보기</button></td>
        `;
        tbody.appendChild(row);
      });
    }

    window.onload = renderPosts;
  </script>
</body>
</html>

